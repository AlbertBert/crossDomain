<!DOCTYPE html>
<html lang="zh-cn-Hans">
<head>
  <meta charset="utf-8">
  <title>postMessage跨域演示</title>
</head>
<body>
  <p>我是http://localhost:3008所在的页面</p>
  <div>
    <input id="btn" type="button" value="点我请求localhost:3009端口">
  </div>
  <iframe src="http://localhost:3009" frameborder="0"></iframe>
  <h2 id="content"></h2>
  <script>
    //3008和3009虽然域名都相同但是端口不同，因此点击按钮会产生跨域问题
    var btn = document.getElementById('btn');
    //定义相应的回调函数
    btn.onclick = function(e) {
      document.getElementsByTagName('iframe')[0].contentWindow.postMessage({"age":10}, 'http://localhost:3009');
    }
    // 监听有没有数据发送过来
    window.addEventListener('message', function(e) {
      console.log(e);
    });
  </script>
</body>
</html>
